## Why

当前 GitHub 仓库下载器脚本的控制按钮固定在页面右下角，用户无法自定义位置，这在某些情况下会造成视觉干扰，影响浏览体验。通过实现智能按钮交互系统，用户可以自由拖拽调整按钮位置，按钮能够智能吸附边缘并半隐藏，在减少视觉干扰的同时保持功能可访问性。

## What Changes

- **拖拽移动功能**：用户可以通过按住按钮并拖动到屏幕任意位置，支持 3px 位移阈值区分拖拽和点击
- **边缘吸附功能**：当按钮接近屏幕左右边缘 20px 范围内时自动吸附到边缘，对齐到边界
- **半隐藏效果**：按钮停靠到边缘后，延迟 400ms 自动隐藏 50%，鼠标悬停时立即展开
- **智能面板定位**：控制面板根据按钮位置自动选择最佳展开方向（上左、上右、下左、下右）
- **状态持久化**：使用 GM_setValue/GM_getValue 保存按钮位置、停靠状态、自动隐藏开关等设置
- **窗口响应式**：浏览器窗口大小改变时自动检查按钮位置有效性，超出边界则重置到默认位置
- **用户控制菜单**：通过 GM_registerMenuCommand 提供重置位置、切换自动隐藏、查看状态等功能
- **CSS 样式更新**：新增拖拽状态、停靠状态、悬停效果的样式类
- **调试日志改进**：使用 GM_setValue/GM_getValue 持久化调试开关状态，添加菜单命令控制，解决页面刷新后需重新开启的问题
- **调试模式自动刷新**：通过右键菜单切换调试模式时，在用户确认后自动刷新页面，使新的调试设置立即生效，无需手动刷新

## Capabilities

### New Capabilities
- `button-dragging`: 按钮拖拽移动功能，支持边界限制和拖拽/点击区分
- `edge-snapping`: 边缘吸附功能，支持左右边缘自动吸附对齐
- `auto-hiding`: 自动半隐藏功能，停靠后延迟隐藏，悬停时展开
- `smart-panel-positioning`: 智能面板定位，根据按钮位置自动计算最佳展开方向
- `state-persistence`: 状态持久化，保存和恢复按钮位置、停靠状态、用户偏好设置
- `menu-commands`: 右键菜单命令，提供重置位置、切换设置、查看状态、切换调试模式等功能
- `debug-logging`: 持久化调试日志开关，通过菜单命令控制，刷新页面后保持设置

### Modified Capabilities
- 无现有 spec 需要修改，本次为纯功能新增

## Impact

- **代码文件**：`GitHub 仓库下载器-1.0.user.js` 主脚本文件
- **GM API**：新增使用 `GM_setValue`、`GM_getValue`、`GM_registerMenuCommand` 三个 API
- **Tampermonkey 元数据**：需要在脚本头部 `@grant` 声明中添加上述三个 API
- **UI 样式**：新增按钮拖拽、停靠、隐藏状态的 CSS 类
- **向后兼容**：首次安装时无保存的状态，使用默认位置；升级后自动启用新功能
- **性能影响**：最小，主要为事件监听和本地存储读写操作
- **浏览器兼容性**：现代浏览器均支持，依赖标准 DOM API 和 CSS3
